<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.75.1"><meta charset=utf-8><title>Are Random Forest Feature Importances Useful?</title><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><link rel=stylesheet href=/2021-lt-is-random-forest-feature-important/reveal-js/css/reset.css><link rel=stylesheet href=/2021-lt-is-random-forest-feature-important/reveal-js/css/reveal.css><link rel=stylesheet href=/2021-lt-is-random-forest-feature-important/_.min.2fcb69e6880a2494a090f1c384a9c19ab9a4f08f53b1894866fcc7f65e2d898f.css id=theme><link rel=stylesheet href=/2021-lt-is-random-forest-feature-important/highlight-js/monokai-sublime.min.css></head><body><div class=reveal><div class=slides><section><h1 id=are-random-forest-feature-importances-useful>Are Random Forest Feature Importances Useful?</h1><p>Thomas J. Fan</p><p><p class=social-author>@thomasjpfan</p><a href=https://www.github.com/thomasjpfan target=_blank><span class="icon icon-github icon-left"></span></a><a href=https://www.twitter.com/thomasjpfan target=_blank><span class="icon icon-twitter"></span></a><div></div><a class=this-talk-link , href=https://github.com/thomasjpfan/2021-lt-is-random-forest-feature-important target=_blank>This talk on Github: thomasjpfan/2021-lt-is-random-forest-feature-important</a></p></section><section><h1 id=sometimes->Sometimes ðŸ¤”</h1></section><section><h2 id=load-a-sample-dataset>Load A Sample Dataset</h2><pre><code class=language-python data-line-numbers=1,4-5|2,7>from sklearn.datasets import load_diabetes
from sklearn.model_selection import train_test_split

diabetes = load_diabetes(as_frame=True)
X, y = diabetes['data'], diabetes['target']

X_train, X_test, y_train, y_test = train_test_split(X, y)
</code></pre></section><section><h2 id=what-does-that-dataset-look-like>What does that dataset look like?</h2><table><thead><tr><th style=text-align:right></th><th style=text-align:right>age</th><th style=text-align:right>sex</th><th style=text-align:right>bmi</th><th style=text-align:right>bp</th></tr></thead><tbody><tr><td style=text-align:right>0</td><td style=text-align:right>0.0380759</td><td style=text-align:right>0.0506801</td><td style=text-align:right>0.0616962</td><td style=text-align:right>0.0218724</td></tr><tr><td style=text-align:right>1</td><td style=text-align:right>-0.00188202</td><td style=text-align:right>-0.0446416</td><td style=text-align:right>-0.0514741</td><td style=text-align:right>-0.0263278</td></tr><tr><td style=text-align:right>2</td><td style=text-align:right>0.0852989</td><td style=text-align:right>0.0506801</td><td style=text-align:right>0.0444512</td><td style=text-align:right>-0.00567061</td></tr><tr><td style=text-align:right>3</td><td style=text-align:right>-0.0890629</td><td style=text-align:right>-0.0446416</td><td style=text-align:right>-0.011595</td><td style=text-align:right>-0.0366564</td></tr><tr><td style=text-align:right>4</td><td style=text-align:right>0.00538306</td><td style=text-align:right>-0.0446416</td><td style=text-align:right>-0.0363847</td><td style=text-align:right>0.0218724</td></tr></tbody></table></section><section><h2 id=training-random-forest-regressors>Training Random Forest Regressors!</h2><pre><code class=language-python data-line-numbers=1-4|6-7>from sklearn.metrics import mean_squared_error
from sklearn.ensemble import RandomForestRegressor

rf_base = RandomForestRegressor(random_state=0).fit(X_train, y_train)

mean_squared_error(y_test, rf_base.predict(X_test))
# 4000.6
</code></pre></section><section><h3 id=how-to-get-feature-importances>How to get feature importances</h3><pre><code class=language-python>rf_base.feature_importances_
# array([0.06140494, 0.01331342, 0.29823963, 0.09571546, 0.04687954,
#        0.05390033, 0.05259927, 0.02711794, 0.27920886, 0.0716206 ])
</code></pre></section><section><figure><img src=images/impurity.png height=640px></figure></section><section><h2 id=insert-some-random-integer-data>Insert some random integer data</h2><pre><code class=language-python data-line-numbers=1-2|4-5|7-8>from numpy.random import default_rng
rng = default_rng(100)

X_random_int = X_train.assign(
    random_int=rng.integers(0, high=2, size=X_train.shape[0]))

X_random_int.loc[:4, &quot;random_int&quot;].to_numpy()
# array([1, 1, 0, 1, 0])
</code></pre></section><section><h2 id=train-a->Train a ðŸŽ„ðŸŽ„ðŸŽ„ðŸŽ„</h2><pre><code class=language-python>from sklearn.ensemble import RandomForestRegressor
rf_random_int = (RandomForestRegressor(random_state=0)
                 .fit(X_random_int, y_train))
</code></pre></section><section><h2 id=will-the-random-integer-be-important-for->Will the random integer be important for ðŸŽ„ðŸŽ„ðŸŽ„ðŸŽ„?</h2><div class="g g-middle g-center"><div class="g-1 g-success"><p>Please Y for <em>Yes</em></p></div><div class="g-1 g-alert"><p>Please N for <em>No</em></p></div></div></section><section><figure><img src=images/impurity_random_int.png height=640px></figure></section><section><h2 id=insert-some-random-uniform-data>Insert some random uniform data</h2><pre><code class=language-python data-line-numbers=1-2|4-5>X_uniform_random = X_train.assign(
    random_uniform=rng.random(size=X_train.shape[0]))

X_uniform_random.loc[:4, &quot;random_uniform&quot;].to_numpy()
# array([0.34703067, 0.23571476, 0.20958332, 0.34343029, 0.40482601])
</code></pre></section><section><h2 id=train-a--1>Train a ðŸŽ„ðŸŽ„ðŸŽ„ðŸŽ„</h2><pre><code class=language-python>rf_uniform_random = (RandomForestRegressor(random_state=0)
                    .fit(X_uniform_random, y))
</code></pre></section><section><h2 id=will-the-random-uniform-feature-be-important-for->Will the random uniform feature be important for ðŸŽ„ðŸŽ„ðŸŽ„ðŸŽ„?</h2><div class="g g-middle g-center"><div class="g-1 g-success"><p>Please 1 for <em>Yes</em></p></div><div class="g-1 g-alert"><p>Please 0 for <em>No</em></p></div></div></section><section><figure><img src=images/impurity_very_random.png height=640px></figure></section><section><h1 id=does-shap-values-do-better-for-random-uniform-features->Does SHAP values do better for random uniform features? ðŸ’¡</h1></section><section><h2 id=nope>Nope</h2><figure><img src=images/shap_uniform_random.png height=640px></figure></section><section><h1 id=are-random-forest-feature-importances-useful-1>Are Random Forest Feature Importances Useful?</h1><h2 id=sometimes--1><strong>Sometimes</strong> ðŸ¤”</h2></section></div></div><script type=text/javascript src=/2021-lt-is-random-forest-feature-important/reveal-hugo/object-assign.js></script><a href=/2021-lt-is-random-forest-feature-important/reveal-js/css/print/ id=print-location style=display:none></a><script type=text/javascript>var printLocationElement=document.getElementById('print-location');var link=document.createElement('link');link.rel='stylesheet';link.type='text/css';link.href=printLocationElement.href+(window.location.search.match(/print-pdf/gi)?'pdf.css':'paper.css');document.getElementsByTagName('head')[0].appendChild(link);</script><script type=application/json id=reveal-hugo-site-params>{"custom_theme":"custom-theme.scss","custom_theme_compile":true,"height":720,"highlight_theme":"monokai-sublime","transition_speed":"fast","width":1280}</script><script type=application/json id=reveal-hugo-page-params>null</script><script src=/2021-lt-is-random-forest-feature-important/reveal-js/js/reveal.js></script><script type=text/javascript>function camelize(map){if(map){Object.keys(map).forEach(function(k){newK=k.replace(/(\_\w)/g,function(m){return m[1].toUpperCase()});if(newK!=k){map[newK]=map[k];delete map[k];}});}
return map;}
var revealHugoDefaults={center:true,controls:true,history:true,progress:true,transition:"slide"};var revealHugoSiteParams=JSON.parse(document.getElementById('reveal-hugo-site-params').innerHTML);var revealHugoPageParams=JSON.parse(document.getElementById('reveal-hugo-page-params').innerHTML);var options=Object.assign({},camelize(revealHugoDefaults),camelize(revealHugoSiteParams),camelize(revealHugoPageParams));Reveal.initialize(options);</script><script type=text/javascript src=/2021-lt-is-random-forest-feature-important/reveal-js/plugin/markdown/marked.js></script><script type=text/javascript src=/2021-lt-is-random-forest-feature-important/reveal-js/plugin/markdown/markdown.js></script><script type=text/javascript src=/2021-lt-is-random-forest-feature-important/reveal-js/plugin/highlight/highlight.js></script><script type=text/javascript src=/2021-lt-is-random-forest-feature-important/reveal-js/plugin/zoom-js/zoom.js></script><script type=text/javascript src=/2021-lt-is-random-forest-feature-important/reveal-js/plugin/notes/notes.js></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]},svg:{fontCache:'global'}};</script><script type=text/javascript id=MathJax-script async src=https://thomasjpfan.github.io/2021-lt-is-random-forest-feature-important//javascript/tex-svg.js></script><link rel="shortcut icon" href=https://thomasjpfan.github.io/2021-lt-is-random-forest-feature-important//favicon.ico></body></html>